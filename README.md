This project demonstrates the use of OpenAI's GPT and embedding models to analyze and interact with parliamentary committee minutes from Japan. It consists of two scripts that handle data processing, embedding generation, and question-answering workflows.

---

## **File Descriptions**

### **Script 1: Embedding Generation**
**File Name:** Main Script for Embedding Calculation

This script generates embeddings for committee meeting minutes and stores them for later use.

#### **Workflow**
1. **Loading Meeting Data**:
    - Function: `load_json_files`
    - This function loads JSON files containing agenda and meeting content from a structured directory (e.g., `Volume_001/full_text.json`).
    - It aggregates all agendas and meeting content into lists.

2. **Splitting Text for Token Limit Compliance**:
    - Function: `split_text`
    - Ensures that text does not exceed the token limits of the embedding model (`text-embedding-ada-002`).

3. **Processing Content**:
    - Function: `process_contents`
    - Splits long content items into manageable chunks and maps them back to their original indices for traceability.

4. **Chunk Management**:
    - Function: `chunk_texts`
    - Combines smaller chunks of text into groups, ensuring token counts stay within the model's constraints.

5. **Embedding Calculation**:
    - Embeddings are calculated for each chunk using OpenAI's `text-embedding-ada-002` model.
    - Progress is displayed during the calculation.

6. **Saving Results**:
    - The script saves embeddings, processed texts, and content mappings in a `pickle` file (`embeddings.pkl`).

---

### **Script 2: Question-Answering Application**
**File Name:** ChatGPT-powered Question Answering Script

This script uses precomputed embeddings to find relevant data and answer user questions based on parliamentary meeting minutes.

#### **Workflow**
1. **Loading Meeting Data**:
    - Function: `load_json_files`
    - Similar to the first script, this loads agendas and meeting contents.

2. **Translating Agendas**:
    - Function: `translate_agendas`
    - Uses OpenAI's `gpt-3.5-turbo` model to translate agendas into English for display.

3. **Embedding and Content Management**:
    - The script loads precomputed embeddings (`embeddings.pkl`) generated by the first script.

4. **Question Similarity Matching**:
    - Function: `calculate_similarity`
    - Compares a user's question embedding to precomputed embeddings using cosine similarity.
    - Identifies top related content items based on similarity scores.

5. **Answer Generation**:
    - Function: `generate_answer`
    - Uses OpenAI's `gpt-3.5-turbo` model to construct an answer based on the user's question and related content.

6. **Interactive Workflow**:
    - The user inputs a question about the committee's minutes.
    - The script retrieves relevant discussions and generates a detailed, context-aware answer.

---

## **Setup Instructions**

### **1. Requirements**
The project requires the following dependencies:

- Python 3.8+
- Required Python Packages:
    - `openai`
    - `tiktoken`
    - `pickle`
    - `scikit-learn`
    - `numpy`
    - `python-dotenv`

### **2. Setting Up the Environment**
1. Clone the repository and navigate to the project directory.
2. Install dependencies:
    ```bash
    pip install -r requirements.txt
    ```
3. Create a `.env` file with your OpenAI API key:
    ```
    OPENAI_API_KEY=your_api_key_here
    ```

### **3. Running the Scripts**

#### **Step 1: Generate Embeddings**
1. Ensure the directory structure of JSON files matches the expected format (e.g., `Volume_001/full_text.json`).
2. Run the embedding generation script:
    ```bash
    python embedding_generation_script.py
    ```
3. This will produce a file named `embeddings.pkl` containing precomputed embeddings.

#### **Step 2: Question Answering**
1. Run the question-answering script:
    ```bash
    python question_answering_script.py
    ```
2. The script will:
    - Display translated agendas.
    - Prompt you to input a question.
    - Provide detailed answers based on the meeting content.

---

## **Features**

1. **Data Processing**:
    - Efficiently handles large datasets by splitting and chunking text into manageable parts.
    
2. **Embeddings**:
    - Uses OpenAI's `text-embedding-ada-002` to generate dense vector representations of meeting content.

3. **Similarity Matching**:
    - Identifies the most relevant content items using cosine similarity.

4. **Interactive Question Answering**:
    - Provides detailed, context-aware answers to user questions in English.

5. **Translation**:
    - Automatically translates Japanese agendas into English for better accessibility.

---

## **Customization**

1. **Change the Token Limit**:
    - Adjust `max_content_tokens` or `max_tokens` in the `process_contents` or `chunk_texts` functions to match your model constraints.

2. **Add More Models**:
    - Extend functionality by integrating additional OpenAI models (e.g., `gpt-4`).

3. **Support for Other Languages**:
    - Modify the `generate_answer` and `translate_agendas` prompts to support other languages.

---

## **Future Improvements**

1. **Caching Results**:
    - Cache embeddings for reuse to avoid redundant API calls.

2. **Scalability**:
    - Add multiprocessing to speed up embedding calculations for large datasets.

3. **Enhanced Search**:
    - Use more advanced similarity techniques or hierarchical clustering for better content retrieval.

4. **Visualization**:
    - Create a frontend interface to display agendas, related content, and answers interactively.

---
